rules:
  - id: weak-password-policy
    languages:
      - javascript
    severity: WARNING
    message: >
      Weak password policy detected.
      Password is accepted without validation for length or complexity.
    metadata:
      category: security
      cwe: "CWE-521: Weak Password Requirements"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: MEDIUM
    patterns:
      - pattern-inside: |
          app.post(..., (req, res) => {
            ...
          }
      - pattern-either:
          - pattern: |
              password: req.body.password
          - pattern: |
              const $P = req.body.password
      - pattern-not-inside: |
          if (...password...)
